(function(n){var t={_cfg:{event:"DOMNodeInserted",modelName:"",hiddenIndexFieldClass:"aspModelIndexer-hidden-index",dataIndexAttr:"data-index",autoUpdate:!0},init:function(t){n.extend(this._cfg,t);this._cfg.rowSelector="."+this._cfg.rowClassName;n.each(this._cfg,function(t,i){if(typeof i=="string")return n.trim(i)});var i=function(n){return n.hasClass(this._cfg.rowClassName)}.bind(this);if(this._cfg.event&&this._cfg.autoUpdate)this._el.on(this._cfg.event,function(t){var u=this._cfg.rowSelector&&this._cfg.event==="DOMNodeInserted",r;u?(r=n(t.originalEvent.target),i(r)&&this.update()):this.update()}.bind(this));return this.update(),this._el},update:function(){var t=":not([{0}])".replace("{0}",this._cfg.dataIndexAttr),i={},r;return this._cfg.rowSelector?(t=this._cfg.rowSelector+t,i=this._el.find(t)):i=this._el.find(t),(!this._lastIndex||this._lastIndex<=0)&&(r={},r=this._cfg.rowSelector?this._el.find(this._cfg.rowSelector):this._el.children(),this._lastIndex=r.length-i.length),this._lastIndex==0&&(this._lastIndex=1),i.each(function(t,i){var u=this._lastIndex++,e="",r,o,f;e=this._cfg.modelName?'input[name*="{0}"]:not([type="button"]):not([type="button"])'.replace("{0}",this._cfg.modelName):'input[name]:not([type="button"]):not([type="button"])';r=n(i);r.find(e).each(function(t,i){this.setInputIndex(u,n(i))}.bind(this));o=this._cfg.modelName+".Index";f=r.find(o);f&&f.length>0?f.val(u):this.appendHiddenIndexInput(u,r);r.attr(this._cfg.dataIndexAttr,u)}.bind(this)),this._el},appendHiddenIndexInput:function(t,i){var r=this;return t=t||this._lastIndex,n("<input/>",{type:"hidden",name:r._cfg.modelName+".Index",value:t}).appendTo(i),this._el},setInputIndex:function(n,t){var i=t.attr("name"),r=new RegExp("(\\[\\d+\\])"),u=i.replace(r,"["+n+"]");return t.attr("name",u),this._el},setCounterValue:function(n){!isNaN(parseFloat(n))&&isFinite(n)&&(this._lastIndex=n)}};n.fn.aspnetCollectionBinder=function(i){var u="asp-collection-binder-instance",r=this.data(u);if(r||(r=Object.create(t),r._el=this,this.data(u,r)),r[i])return r[i].apply(r,Array.prototype.slice.call(arguments,1));if(typeof i!="object"&&i)n.error('aspnetCollectionBinder: Method "'+i+'" not exists');else return r.init.apply(r,arguments)}})(jQuery);