(function(e){var t={_cfg:{event:"DOMNodeInserted",modelName:"",hiddenIndexFieldClass:"aspModelIndexer-hidden-index",dataIndexAttr:"data-index",autoUpdate:true},init:function(t){e.extend(this._cfg,t);this._cfg.rowSelector="."+this._cfg.rowClassName;e.each(this._cfg,function(t,n){if(typeof n==="string"){return e.trim(n)}});var n=function(e){return e.hasClass(this._cfg.rowClassName)}.bind(this);if(this._cfg.event&&this._cfg.autoUpdate){this._el.on(this._cfg.event,function(t){var r=this._cfg.rowSelector&&this._cfg.event==="DOMNodeInserted";if(r){var i=e(t.originalEvent.target);if(n(i)){this.update()}}else{this.update()}}.bind(this))}this.update();return this._el},update:function(){var t=":not([{0}])".replace("{0}",this._cfg.dataIndexAttr),n={},r={};if(!this._cfg.rowSelector){n=this._el.find(t)}else{t=this._cfg.rowSelector+t;n=this._el.find(t)}if(!this._lastIndex||this._lastIndex<=0){if(!this._cfg.rowSelector){r=this._el.children()}else{r=this._el.find(this._cfg.rowSelector)}this._lastIndex=r.length-n.length}if(this._lastIndex==0){this._lastIndex=1}n.each(function(t,n){var r=this._lastIndex++,i="",s=e(n),o=this._cfg.modelName+".Index",u=s.find(o);if(!this._cfg.modelName){i='input[name]:not([type="button"]):not([type="button"])'}else{i='input[name*="{0}"]:not([type="button"]):not([type="button"])'.replace("{0}",this._cfg.modelName)}s.find(i).each(function(t,n){this.setInputIndex(r,e(n))}.bind(this));if(u&&u.length>0){u.val(r)}else{this.appendHiddenIndexInput(r,s)}s.attr(this._cfg.dataIndexAttr,r)}.bind(this));return this._el},appendHiddenIndexInput:function(t,n){var r=this;t=t||this._lastIndex;e("<input/>",{type:"hidden",name:r._cfg.modelName+".Index",value:t}).appendTo(n);return this._el},setInputIndex:function(e,t){var n=t.attr("name"),r=new RegExp("(\\[\\d+\\])"),i=n.replace(r,"["+e+"]");t.attr("name",i);return this._el},setCounterValue:function(e){if(!isNaN(parseFloat(e))&&isFinite(e)){this._lastIndex=e}}};e.fn.aspnetCollectionBinder=function(n){var r="asp-collection-binder-instance",i=this.data(r);if(!i){i=Object.create(t);i._cfg=Object.create(t._cfg);i._el=this;this.data(r,i)}if(i[n]){return i[n].apply(i,Array.prototype.slice.call(arguments,1))}else if(typeof n==="object"||!n){return i.init.apply(i,arguments)}else{e.error('aspnetCollectionBinder: Method "'+n+'" not exists')}}})(jQuery)